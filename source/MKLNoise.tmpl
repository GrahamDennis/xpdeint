@*
MKLNoise.tmpl

Created by Graham Dennis on 2007-12-12.
Copyright (c) 2007 __MyCompanyName__. All rights reserved.
*@
@extends Noise
@from Decorators import callOncePerClassGuard
@import random

@def description: Generic Intel MKL noise
@def generatorType: VSLStreamStatePtr

@@callOncePerClassGuard
@def cflags
@*doc:
Return the options that need to be added to ``CFLAG``.
*@
  @#
-lguide -lvml@slurp
  @#
@end def

@*
  Static includes
*@
@@callOncePerClassGuard
@def static_includes
  @#
  @super
#include <mkl_vsl.h>
  @#
@end def

@*
  Globals
*@
@def globals
  @#
VSLStreamStatePtr ${generatorName};
  @#
@end def

@*
  Initialise seeds
*@
@def initialiseSeeds
  @#
  @set $featureOrdering = ['Driver']
  @silent seedOffset = $insertCodeForFeatures('seedOffset', $featureOrdering)
  @#
  @if len($seedArray)
vslNewStream(&${generatorName}, VSL_BRNG_MT19937, $seedArray[0]${seedOffset});
  @else
  @set self.generatedSeeds = [random.randrange(0, pow(2, 32))]
vslNewStream(&${generatorName}, VSL_BRNG_MT19937, ${generatedSeeds[0]}${seedOffset});
  @end if
  @#
@end def
